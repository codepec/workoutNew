<!doctype html>
<html lang="de" data-theme="dark">
<head>

<meta charset="utf-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover">

<title>Iron Insanity</title>

<meta name="theme-color" content="#020617">
<meta name="color-scheme" content="dark">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="manifest" href="/manifest.json">

<style>

/* RESET + BACKGROUND */

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #020617;
}

body {
  min-height: 100dvh;
  background: linear-gradient(135deg,#020617,#0f172a);
  color: white;
  font-family: system-ui, Arial;
  display: flex;
  flex-direction: column;
  align-items: center;
}

body::before {
  content:"";
  position: fixed;
  inset: 0;
  background: linear-gradient(135deg,#020617,#0f172a);
  z-index: -1;
}

/* CARD */

.hero-card{
  background:#111827;
  border:2px solid #374151;
  border-radius:22px;
  padding:24px;
  max-width:400px;
  width:85%;
  text-align:center;
  box-shadow:0 10px 30px rgba(0,0,0,.5);
  margin-top:40px;
}

/* LABELS */

.label-card{
  background: rgba(34,197,94,0.1);
  border: 2px solid #22c55e;
  border-radius: 14px;
  padding: 12px 20px;
  margin-bottom: 14px;
  font-size: 1.5rem;
  font-weight: 800;
  color: #22c55e;
}

.label-card.exercise{
  background: rgba(59,130,246,0.1);
  border: 2px solid #fff;
  color: #fff;
  margin-bottom: 30px;
}

/* BUTTONS */

.start-btn{
  background:#22c55e;
  color:black;
  font-weight:700;
  font-size:1.15rem;
  padding:18px;
  border:none;
  border-radius:16px;
  cursor:pointer;
  width:100%;
  margin-top:10px;
}

.secondary-btn{
  background:#374151;
  color:white;
  font-weight:700;
  font-size:1rem;
  padding:14px;
  border:none;
  border-radius:16px;
  width:100%;
  margin-top:12px;
}

/* TITLE */

h1{
  margin-top:60px;
  font-size:2rem;
  text-align:center;
  color:#22c55e;
}

.session-info{
  font-size:.9rem;
  opacity:.7;
  margin-bottom:10px;
}

</style>
</head>

<body>

<h1>IRON INSANITY</h1>

<div class="hero-card">

  <div class="label-card" id="weekLabel"></div>
  <div class="label-card exercise" id="dayLabel"></div>
  <div class="session-info" id="sessionInfo"></div>

  <button class="start-btn" id="startBtn"></button>

  <button class="secondary-btn" onclick="goToPreview()">Vorschau</button>
  <button class="secondary-btn" onclick="goToHistory()">Verlauf</button>
  <button class="secondary-btn" onclick="changeWeek()">Woche wechseln</button>

</div>

<script>

/* =========================
   WORKOUT ORDER
========================= */

const order = ["Push","Pull","Legs"];
const week = parseInt(localStorage.getItem("selectedWeek")) || 1;

const weekLabel = document.getElementById("weekLabel");
const dayLabel = document.getElementById("dayLabel");
const startBtn = document.getElementById("startBtn");
const sessionInfo = document.getElementById("sessionInfo");

weekLabel.innerText = `Woche ${week}`;

/* =========================
   SESSION CHECK
========================= */

let session = JSON.parse(localStorage.getItem("workoutSession") || "null");

/* ---------- AKTIVE SESSION ---------- */

if(session && session.finished === false){

  dayLabel.innerHTML = `Aktives Training<br><strong>${session.day}</strong>`;

  startBtn.innerText = "Training fortsetzen";

  const startTime = new Date(session.startedAt);
  sessionInfo.innerText =
    "Start: " + startTime.toLocaleString();

  startBtn.onclick = () => {
    location.href="./pages/cards.html";
  };
}

/* ---------- KEINE SESSION ---------- */

else{

  const lastDay = localStorage.getItem("lastDay");

  function nextFrom(last){
    if(!last) return "Push";
    return order[(order.indexOf(last)+1)%order.length];
  }

  const nextDay = nextFrom(lastDay);

  dayLabel.innerHTML =
    `NÃ¤chstes Training<br><strong>${nextDay}</strong>`;

  startBtn.innerText = "Training starten";
  sessionInfo.innerText = "";

  startBtn.onclick = () => {

    const newSession = {
      week: week,
      day: nextDay,
      startedAt: Date.now(),
      finished:false,
      difficultyFactor:1.0
    };

    localStorage.setItem(
      "workoutSession",
      JSON.stringify(newSession)
    );

    location.href="./pages/cards.html";
  };
}

/* =========================
   NAVIGATION
========================= */

function goToPreview(){ location.href="./pages/preview.html"; }
function goToHistory(){ location.href="./pages/history.html"; }
function changeWeek(){ location.href="./pages/week.html"; }

</script>

</body>
</html>
